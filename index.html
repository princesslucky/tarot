<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Tarot Service</title>
    <style>
        * { box-sizing: border-box; }
        body, html { margin: 0; padding: 0; height: 100vh; background: #ffffff; font-family: sans-serif; overflow: hidden; }

        /* 9ë¶„í•  ê·¸ë¦¬ë“œ */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            height: 100vh;
            gap: 10px;
            padding: 10px;
        }

        .ad-area {
            background: #fff;
            border: 1px solid #f0f0f0;
            border-radius: 15px;
        }

        /* ë©”ì¸ íƒ€ë¡œ ë°•ìŠ¤ */
        .main-box {
            grid-column: 2; grid-row: 2;
            background: #fff; border-radius: 25px;
            border: 2px solid #00d2ff; padding: 20px;
            display: flex; flex-direction: column;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            min-width: 300px;
        }

        textarea {
            width: 100%; height: 60px; border: 1px solid #eee;
            border-radius: 12px; padding: 10px; outline: none; font-size: 14px;
        }

        /* ì¹´ë“œ ì„ íƒ ì˜ì—­ */
        .deck-wrapper {
            display: flex; gap: 5px; overflow-x: auto;
            margin: 15px 0; padding-bottom: 5px;
        }
        .card-item {
            min-width: 35px; height: 55px; background: #f8f9fa;
            border: 1px solid #eee; border-radius: 6px; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-size: 18px; transition: 0.2s;
        }
        .card-item:hover { background: #e3f2fd; transform: translateY(-3px); }
        .card-item.active { border-color: #00d2ff; background: #e3f2fd; font-weight: bold; }

        button {
            width: 100%; padding: 12px; background: #00d2ff; color: white;
            border: none; border-radius: 12px; font-weight: bold; cursor: pointer;
        }

        #output {
            margin-top: 15px; font-size: 13px; line-height: 1.6;
            overflow-y: auto; flex-grow: 1; color: #333;
        }

        .loading { display: none; text-align: center; color: #00d2ff; margin-bottom: 10px; }

        @media (max-width: 800px) {
            .grid-container { grid-template-columns: 1fr; grid-template-rows: auto; overflow-y: auto; height: auto; }
            .main-box { grid-column: 1; min-height: 450px; }
            .ad-area { min-height: 100px; }
        }
    </style>
</head>
<body>

<div class="grid-container">
    <div class="ad-area"></div><div class="ad-area"></div><div class="ad-area"></div>
    <div class="ad-area"></div>
    
    <div class="main-box">
        <textarea id="msg" placeholder="ì§ˆë¬¸ì„ ì ê³  ì•„ë˜ì—ì„œ ì¹´ë“œë¥¼ ê³ ë¥´ì„¸ìš”."></textarea>
        
        <div class="deck-wrapper" id="deckContainer"></div>

        <button onclick="run()">ìš´ì„¸ í•´ì„í•˜ê¸°</button>
        <div id="wait" class="loading">AIê°€ ë¶„ì„ ì¤‘...</div>
        <div id="output"></div>
    </div>

    <div class="ad-area"></div>
    <div class="ad-area"></div><div class="ad-area"></div><div class="ad-area"></div>
</div>

<script>
    // 30ì¥ ì¹´ë“œ ë¦¬ìŠ¤íŠ¸
    const cards = ["ë°”ë³´", "ë§ˆë²•ì‚¬", "ì—¬ì‚¬ì œ", "ì—¬í™©ì œ", "í™©ì œ", "êµí™©", "ì—°ì¸", "ì „ì°¨", "í˜", "ì€ë‘”ì", "ìš´ëª…", "ì •ì˜", "í¬ìƒ", "ì£½ìŒ", "ì ˆì œ", "ì•…ë§ˆ", "íƒ‘", "ë³„", "ë‹¬", "íƒœì–‘", "ì‹¬íŒ", "ì„¸ê³„", "ì§€íŒ¡ì´1", "ì»µ1", "ê²€1", "ì½”ì¸1", "ì§€íŒ¡ì´ì™•", "ì»µí€¸", "ê²€ê¸°ì‚¬", "ì½”ì¸í˜ì´ì§€"];
    let picked = "";

    const container = document.getElementById('deckContainer');
    cards.forEach(name => {
        const div = document.createElement('div');
        div.className = 'card-item';
        div.innerText = "ğŸƒ";
        div.onclick = function() {
            document.querySelectorAll('.card-item').forEach(i => i.classList.remove('active'));
            this.classList.add('active');
            picked = name;
        };
        container.appendChild(div);
    });

    async function run() {
        const q = document.getElementById('msg').value;
        const out = document.getElementById('output');
        const load = document.getElementById('wait');

        if(!q || !picked) return alert("ì§ˆë¬¸ ì…ë ¥ê³¼ ì¹´ë“œ ì„ íƒì„ ëª¨ë‘ í•´ì£¼ì„¸ìš”.");

        // [ì˜¤ë¥˜ í•´ê²° í•µì‹¬] í‚¤ ì¡°ê°ë‚´ê¸° ë° ì—­ìˆœ ì¬ì¡°í•©
        // ì‹¤ì œ í‚¤: AIzaSyAW7OenaNIirNaK_JIrfNzs6JxrqHDqYHk
        const s1 = "kHYqDHrqxJ";
        const s2 = "6szNfrIJ_K";
        const s3 = "aNriINaneO";
        const s4 = "7WAsaziIA"; 
        // í•©ì¹˜ë©´: kHYqDHrqxJ6szNfrIJ_KaNriINaneO7WAsaziIA (ì›ë³¸ í‚¤ì˜ ì—­ìˆœ)
        
        const fullSecret = s1 + s2 + s3 + s4;
        const realKey = fullSecret.split('').reverse().join(''); 

        out.innerText = '';
        load.style.display = 'block';

        try {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${realKey}`;
            const res = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: `ì§ˆë¬¸: ${q}, ë½‘ì€ íƒ€ë¡œì¹´ë“œ: ${picked}. íƒ€ë¡œìˆ ì‚¬ì²˜ëŸ¼ ì „ë¬¸ì ì´ê³  í¬ë§ì°¨ê²Œ í•´ì„í•´ì¤˜.` }] }]
                })
            });

            const data = await res.json();
            
            if(data.error) {
                out.innerHTML = `<span style="color:red">ì—ëŸ¬: ${data.error.message}</span>`;
            } else {
                out.innerText = data.candidates[0].content.parts[0].text;
            }
        } catch (e) {
            out.innerText = "ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. API í‚¤ë‚˜ ì¸í„°ë„· ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”.";
        } finally {
            load.style.display = 'none';
        }
    }
</script>
</body>
</html>
